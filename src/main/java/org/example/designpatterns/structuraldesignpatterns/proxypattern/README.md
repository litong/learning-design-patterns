# 代理模式

代理模式（Proxy Pattern）是指为其他对象提供一种代理，以控制对这个对象的访问。

代理对象在客服端和目标对象之间起到中介作用。

代理模式属于结构型设计模式

## 代理模式的适用场景

保护目标对象

增强目标对象

## JDK 与 Cglib 实现区别

|        | JDK                                                          | Cglib                                                        |
| ------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 方式   | 采用实现的方式，要求代理的目标对象一定要实现一个接口         | 采用继承的方式，覆盖父类的方法                               |
| 目标类 | 对于用户而言，依赖更强，调用也更加复杂                       | 无法代理被final修饰的方法                                    |
| 比较   | 生成代理的逻辑简单，执行效率相对较低，每一次都要反射动态调用 | 生成代理逻辑更复杂，效率，调用效率更高，生成一个包含了所有逻辑的FastClass，底层没有用到反射 |
|        |                                                              |                                                              |

## Spring 中的代理选择原则

1. 当 Bean 有实现接口时， Spring 就会用JDK的动态代理。
2. 当 Bean 没有实现接口时， Spring 选择CGLib。
3. Spring 可以通过配置强制使用 CGLib ，只需在 Spring 的配置文件中加入如下代码：

```xml
<aop:aspectj-autoproxy proxy-target-class="true"/>
```
